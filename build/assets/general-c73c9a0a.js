var g=Object.defineProperty;var b=(t,a,o)=>a in t?g(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o;var i=(t,a,o)=>(b(t,typeof a!="symbol"?a+"":a,o),o);import{$ as e}from"./pageCommonInit-9ea57622.js";import{M as f,a as s,C as w}from"./modalGeneral-91a492db.js";import{N as v,C}from"./nexusClient-88cb175b.js";const x=[new RegExp("(hp|shakira|petro|Asesinato|asno|bastardo|Bollera|Cabrón|Caca|Chupada|Chupapollas|Chupetón|concha|Coño|Coprofagía|Culo|Drogas|Esperma|Follador|Follar|Gilipichis|Gilipollas|Heroína|Hijaputa|Hijoputa|Idiota|Imbécil|infierno|Jilipollas|Kapullo|Lameculos|Maciza|Macizorra|maldito|Mamada|Marica|Maricón|Mariconazo|martillo|Mierda|Nazi|Orina|Pedo|Pendejo|Pervertido|Pezón|Pinche|Pis|Prostituta|Puta|Racista|Ramera|Sádico|Semen|Sexo|Soplagaitas|Soplapollas|Travesti|Trio|Verga|Vulva)","i"),new RegExp("(acrotomophilia|anilingus|anus|apeshit|arsehole|ass|asshole|assmunch|autoerotic|bangbros|bastard|bbw|beaner|bitch|bitches|blowjob|bondage|boob|boobs|booty|butt|camgirl|clit|cock|cum|dick|dingleberry|erotic|erotism|fingering|fucking|fuck|hot|horny|masturbate|masturbating|nigga|nipple|orgasm|panties|playboy|porn|pornography|pussy|semen|sex|sexcam|sexy|sexual|sexually|sexuality|shit|slut|suck|sucks|tit|tits|titties|twinkie|undressing|vagina|worldsex)","i")];function u(){const t=e("#room-name"),a=t.val();for(const o of x)if(o.test(a))return new f("Advertencia","No se pueden ingresar campos con insultos nombres de famosos o politicos."),t.val(""),!1;return!0}function h(){const t=parseInt(e("#select-number-players").val()),a=e("#select-equipos");t===2||t===3?(a.val(0),a.prop("disabled",!0)):a.prop("disabled",!1)}function p(){const t=e("#select-recompensa-bool"),a=e("#recompensa-cantidad");t.val()==="0"?(a.val(0),a.prop("disabled",!0)):a.prop("disabled",!1),a.attr("min","1")}function y(){h(),p(),e("#roomConfig").show()}e("#btn-create-room").on("click",y);function S(){let t=e("#room-name").val()==null||e("#room-name").val()==""?"Mi_Sala":e("#room-name").val().toString();t=t.replace(/\s/g,"_");let a=e("#select-number-players").val()==null?"2":e("#select-number-players").val().toString(),o=e("#select-equipos").val()==null?"0":e("#select-equipos").val().toString(),n=e("#recompensa-cantidad").val()==null||e("#recompensa-cantidad").val()==""?"0":e("#recompensa-cantidad").val().toString();s.remove("Join"),s.remove("NombreSala"),s.remove("NumeroJugadores"),s.remove("SetEquipos"),s.remove("NumeroRecompensa"),s.set("NombreSala",t,{expires:new Date(Date.now()+3*60*1e3),path:"/",secure:!0,sameSite:"Lax"}),s.set("NumeroJugadores",a,{expires:new Date(Date.now()+3*60*1e3),path:"/",secure:!0,sameSite:"Lax"}),s.set("SetEquipos",o,{expires:new Date(Date.now()+3*60*1e3),path:"/",secure:!0,sameSite:"Lax"}),s.set("NumeroRecompensa",n,{expires:new Date(Date.now()+3*60*1e3),path:"/",secure:!0,sameSite:"Lax"}),window.location.href="./gameView.html"}e("#select-number-players").on("change",function(){h(),p()});e("#select-recompensa-bool").on("change",function(){p()});e("#btn-enviar").on("click",function(){u()?S():console.error("Las validaciones no pasaron. No se puede enviar el formulario.")});e("#btn-up-modal-close, #btn-down-modal-close").on("click",function(){e("#roomConfig").hide()});class M extends w{constructor(o){super(o);i(this,"init",async()=>{e("#btn-create-room").on("click",function(){u()&&e("#roomConfig").show()}),e("#party-list").on("click",".join-party-button",function(){var o=e(this).closest(".card ").find(".card-header").html();s.remove("Join"),s.set("Join",o,{expires:new Date(Date.now()+3*60*1e3),path:"/",secure:!0,sameSite:"Lax"}),window.location.href="./gameView.html"}),e("#refresh-button").on("click",this.loadRoomDataOnList),this.loadRoomDataOnList(),this.dialog.notify(this,"nexusJoinGlobalRoom",{})});i(this,"getChatNode",()=>e("#chat-insert"));i(this,"loadRoomDataOnList",async()=>{try{return e("#party-list").empty(),this.dialog.notify(this,"nexusSearchRooms",{}).then(n=>{n.length>0&&e.get("../../templates/partyListItem.html",function(d){n.forEach(r=>{let l=d,c={"{{id_placeholder}}":r.roomId,"{{name_placeholder}}":r.roomMedatadataNombre,"{{current_placeholder}}":r.roomMetadataClients,"{{max_placeholder}}":r.roomMetadataMaximoClients,"{{bonus_placeholder}}":r.roomMetadataGanancia,"{{mode_placeholder}}":r.roomMetadataEquipos};for(let m in c)c.hasOwnProperty(m)&&(l=l.replace(m,c[m]));e("#party-list").append(l)})})}),!0}catch{return!1}})}}class R{constructor(){i(this,"nexusClient");i(this,"chatComponent");i(this,"generalView");i(this,"init",()=>{this.generalView.init(),this.chatComponent.init(this.generalView.getChatNode())});i(this,"handleGeneralViewEvent",(a,o)=>{let n;switch(a){case"nexusJoinGlobalRoom":this.nexusClient.nexusClientHandleGlobalRoom();break;case"nexusSearchRooms":n=this.nexusClient.nexusClientGetAvaliableRooms();break}return n});i(this,"handleChatEvent",(a,o)=>{switch(a){case"sendChatMessage":const n=o.toString();this.nexusClient.sendChatMessage(n);break}});i(this,"handleNexusClientEvent",(a,o)=>{switch(a){case"newChatGeneralMessage":const n=o;this.chatComponent.insertNewMessage(n.player_name,n.message_content);break}});this.nexusClient=new v(this),this.chatComponent=new C(this),this.generalView=new M(this)}notify(a,o,n){if(a==this.nexusClient&&this.handleNexusClientEvent(o,n),a==this.chatComponent&&this.handleChatEvent(o,n),a==this.generalView)return this.handleGeneralViewEvent(o,n)}}e(()=>{new R().init()});
